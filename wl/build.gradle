/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java application project to get you started.
 * For more details take a look at the 'Building Java & JVM projects' chapter in the Gradle
 * User Manual available at https://docs.gradle.org/7.1/userguide/building_java_projects.html
 */

plugins {
    // Apply the application plugin to add support for building a CLI application in Java.
    id 'application'
}

repositories {
    // Use Maven Central for resolving dependencies.
    mavenCentral()
}

dependencies {
    // Use JUnit test framework.
    testImplementation 'junit:junit:4.13.2'

    // This dependency is used by the application.
    //implementation 'com.google.guava:guava:30.1-jre'

    // https://mvnrepository.com/artifact/commons-io/commons-io
    implementation 'commons-io:commons-io:2.6'

    // flat look-and-feel for Swing
    implementation 'com.formdev:flatlaf:1.4'
}

application {
    // Define the main class for the application.
    mainClass = 'org.akinosoft.worklogger.WorkLogger'
}


task copyDependencies(type: Copy) {
    into "$buildDir/jars"
    from configurations.runtimeClasspath
}

task copyJar(type: Copy) {
    into "$buildDir/jars"
    from tasks.jar
}

task windowsInstaller(type: Exec) {
    dependsOn 'build', 'copyJar', 'copyDependencies'
    workingDir "${buildDir}/jars"
    def jpackage = 'jpackage'
    def name = 'WorkLogger'
    def input = "${buildDir}\\jars"
    def mainjar = tasks.jar.archiveFileName.get()
    def mainclass = application.getMainClass().get()
    def type = 'msi'
    def dest = "${buildDir}"
    def icon = "${rootDir}\\wl.ico"
    def menugroup = 'AkinoSoft'
    def appversion = '1.0.0'
    def appdescription = 'Keep track of your work creating text files of your actions in time.'
    def appvendor = 'AkinoSoft!'
    def appcopyright = 'idaho06 cesar.idaho@gmail.com'

    //commandLine 'cmd', '/c', 'echo', 'Hello', ' world'
    executable 'cmd'
    args '/c', jpackage, '--name', name, '--input', input, '--main-jar', mainjar, '--main-class', mainclass,
         '--type', type, '--dest', dest, '--win-menu', '--win-menu-group', menugroup, '--app-version', appversion,
         '--description', appdescription, '--vendor', appvendor, '--copyright', appcopyright, '--icon', icon,
         '--win-per-user-install', '--win-dir-chooser'
}

